<!--
Copyright 2017 Next Century Corporation

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <title>client-config</title>
  <script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../bower_components/web-component-tester/browser.js"></script>
  <script src="data/ad-data.js" type="text/javascript"></script>
  <link rel="import" href="../elements/client-config/client-config.html">
  <link rel="import" href="../elements/lodash.html">
</head>

<body>
<test-fixture id="client-config-fixture">
  <template>
    <client-config></client-config>
  </template>
</test-fixture>

<script>
  'use strict';
  /* globals _, suite, setup, fixture, test, expect, assert, AD_DATA */
  /* jshint -W030 */
  suite('<client-config> offer tests', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      clientConfig.config = {};
    });

    test('defines config object with offer transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig).to.be.an('Object');
      expect(clientConfig.transforms).to.be.an('Object');
      expect(clientConfig.transforms.offer).to.be.an('Object');
      expect(clientConfig.transforms.offer.offer).to.be.a('Function');
    });

    test('defines offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.equal(output.id, 'FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965');
      assert.equal(output.url, 'http://google.com/abc123');
      assert.equal(output.rank, 1.23);
      assert.equal(output.domain, 'google.com');
      assert.equal(output.type, 'offer');
      assert.equal(output.icon, '');
      assert.equal(output.link, '/offer.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965');
      assert.equal(output.styleClass, '');
      assert.equal(output.title, 'Test Ad');
      assert.equal(output.description, 'The quick brown fox jumped over the lazy dog.');
      assert.isUndefined(output.highlightedText);
    });

    test('defines date array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.dates, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'posting_date',
          user: ''
        },
        confidence: undefined,
        count: undefined,
        id: '2017-02-06T00:00:00',
        icon: 'icons:date-range',
        link: undefined,
        styleClass: 'entity-deep-purple',
        text: 'Feb 6, 2017',
        type: 'date'
      }]);
    });

    test('defines publisher array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.publishers, [{
        annotate: false,
        confidence: undefined,
        count: undefined,
        id: 'google.com',
        icon: 'av:web',
        link: undefined,
        styleClass: 'entity-light-green',
        text: 'google.com',
        type: 'website'
      }]);
    });

    test('defines location array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.locations, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'Roanoke:Virginia:United States:-79.94143:37.27097',
        icon: 'communication:location-on',
        latitude: '37.27097',
        longitude: '-79.94143',
        link: '/location.html?id=Roanoke:Virginia:United States:-79.94143:37.27097',
        styleClass: 'entity-orange',
        text: 'Roanoke, Virginia',
        textAndCount: 'Roanoke, Virginia',
        textAndCountry: 'Roanoke, Virginia, United States',
        type: 'location'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 90,
        count: undefined,
        id: 'Atlanta:Georgia:United States:-84.38798:33.749',
        icon: 'communication:location-on',
        latitude: '33.749',
        longitude: '-84.38798',
        link: '/location.html?id=Atlanta:Georgia:United States:-84.38798:33.749',
        styleClass: 'entity-orange',
        text: 'Atlanta, Georgia',
        textAndCount: 'Atlanta, Georgia',
        textAndCountry: 'Atlanta, Georgia, United States',
        type: 'location'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: 'Brooklyn:New York:United States:-73.94958:40.6501',
        icon: 'communication:location-on',
        latitude: '40.6501',
        longitude: '-73.94958',
        link: '/location.html?id=Brooklyn:New York:United States:-73.94958:40.6501',
        styleClass: 'entity-orange',
        text: 'Brooklyn, New York',
        textAndCount: 'Brooklyn, New York',
        textAndCountry: 'Brooklyn, New York, United States',
        type: 'location'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'Houston:Texas:United States:-95.36327:29.76328',
        icon: 'communication:location-on',
        latitude: '29.76328',
        longitude: '-95.36327',
        link: '/location.html?id=Houston:Texas:United States:-95.36327:29.76328',
        styleClass: 'entity-orange',
        text: 'Houston, Texas',
        textAndCount: 'Houston, Texas',
        textAndCountry: 'Houston, Texas, United States',
        type: 'location'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: 'Columbus:Ohio:United States:-82.99879:39.96118',
        icon: 'communication:location-on',
        latitude: '39.96118',
        longitude: '-82.99879',
        link: '/location.html?id=Columbus:Ohio:United States:-82.99879:39.96118',
        styleClass: 'entity-orange',
        text: 'Columbus, Ohio',
        textAndCount: 'Columbus, Ohio',
        textAndCountry: 'Columbus, Ohio, United States',
        type: 'location'
      }]);
    });

    test('defines phone array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.phones, [{
        annotate: true,
        classifications: {
          database: '',
          type: 'phone',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: '1234567890',
        link: '/phone.html?id=1234567890',
        icon: 'communication:phone',
        styleClass: 'entity-purple',
        text: '123-456-7890',
        type: 'phone'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'phone',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: '+1-2223334444',
        link: '/phone.html?id=+1-2223334444',
        icon: 'communication:phone',
        styleClass: 'entity-purple',
        text: '222-333-4444',
        type: 'phone'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'phone',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '+1-9999999999',
        link: '/phone.html?id=+1-9999999999',
        icon: 'communication:phone',
        styleClass: 'entity-purple',
        text: '999-999-9999',
        type: 'phone'
      }]);
    });

    test('defines email array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.emails, [{
        annotate: true,
        classifications: {
          database: '',
          type: 'email',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'test1@gmail.com',
        link: '/email.html?id=test1%40gmail.com',
        icon: 'communication:email',
        styleClass: 'entity-indigo',
        text: 'test1@gmail.com',
        type: 'email'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'email',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: 'test2@yahoo.com',
        link: '/email.html?id=test2%40yahoo.com',
        icon: 'communication:email',
        styleClass: 'entity-indigo',
        text: 'test2@yahoo.com',
        type: 'email'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'email',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'test3@other.com',
        link: '/email.html?id=test3%40other.com',
        icon: 'communication:email',
        styleClass: 'entity-indigo',
        text: 'test3@other.com',
        type: 'email'
      }]);
    });

    test('defines cache array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.cache, {
        link: '/cache.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965',
        text: 'Open Cached Ad Webpage'
      });
    });

    test('defines review IDs array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.reviewIds, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'review_id',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: '123456',
        icon: 'icons:star',
        link: undefined,
        styleClass: 'entity-yellow',
        text: '123456',
        type: 'review'
      }]);
    });

    test('defines social media IDs array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.socialIds, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'social_media_id',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'username',
        icon: 'social:public',
        link: undefined,
        styleClass: 'entity-red',
        text: 'twitter username',
        type: 'social'
      }]);
    });

    test('defines name array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.names, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'name',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'bianca',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'bianca',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'name',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: 'sweet',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'sweet',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'name',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'woman',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'woman',
        type: 'provider'
      }]);
    });

    test('defines price array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.prices, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'price',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: '180',
        icon: 'editor:monetization-on',
        link: undefined,
        styleClass: 'entity-green',
        text: '180 roses per 60 minutes',
        type: 'price'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'price',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: '120',
        icon: 'editor:monetization-on',
        link: undefined,
        styleClass: 'entity-green',
        text: '120 per 30 minutes',
        type: 'price'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'price',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '75',
        icon: 'editor:monetization-on',
        link: undefined,
        styleClass: 'entity-green',
        text: '75 per 15 minutes',
        type: 'price'
      }]);
    });

    test('defines services array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.services, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'service',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'massage',
        icon: 'icons:work',
        link: undefined,
        styleClass: 'entity-brown',
        text: 'massage',
        type: 'service'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'service',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: 'full body',
        icon: 'icons:work',
        link: undefined,
        styleClass: 'entity-brown',
        text: 'full body',
        type: 'service'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'service',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'deep tissue',
        icon: 'icons:work',
        link: undefined,
        styleClass: 'entity-brown',
        text: 'deep tissue',
        type: 'service'
      }]);
    });

    test('defines age array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.ages, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'age',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: '24',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '24',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'age',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '25',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '25',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'age',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: '1234567890',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '1234567890',
        type: 'provider'
      }]);
    });

    test('defines ethnicity array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.ethnicities, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'ethnicity',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'hispanic',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'hispanic',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'ethnicity',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'brown',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'brown',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'ethnicity',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: 'black',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'black',
        type: 'provider'
      }]);
    });

    test('defines eye color array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.eyeColors, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'eye_color',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'brown',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'brown',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'eye_color',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'black',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'black',
        type: 'provider'
      }]);
    });

    test('defines gender array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.genders, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'gender',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'female',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'female',
        type: 'provider'
      }]);
    });

    test('defines hair color array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.hairColors, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'hair_color',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'black',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'black',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'hair_color',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'brown',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'brown',
        type: 'provider'
      }]);
    });

    test('defines height array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.heights, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'height',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: '155',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '155 cm',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'height',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: '5\'1"',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '5\'1"',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'height',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '60',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '60',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'height',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: '1234567890',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '1234567890',
        type: 'provider'
      }]);
    });

    test('defines weight array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.weights, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'weight',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: '60',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '60 kg',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'weight',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '155',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '155',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'weight',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: '1234567890',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '1234567890',
        type: 'provider'
      }]);
    });

    test('defines detail array in offer', function() {
      var output = clientConfig.transforms.offer.offer(AD_DATA);
      assert.deepEqual(output.details, [{
        name: 'Url',
        link: 'http://google.com/abc123',
        text: 'http://google.com/abc123'
      }, {
        highlightedText: undefined,
        name: 'Description',
        text: 'The quick brown fox jumped over the lazy dog.'
      }, {
        name: 'Cached Ad Webpage',
        link: '/cache.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965',
        text: 'Open'
      }]);
    });
  });

  suite('<client-config> offer tests with highlights', function() {
    var clientConfig;
    var data;
    var output;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      clientConfig.config = {};
      data = _.cloneDeep(AD_DATA);

      data.hits.hits[0].highlight = {
        'content_extraction.title.text': ['<em>Test</em> Ad'],
        'content_extraction.content_strict.text': ['The <em>quick brown</em> fox jumped over the <em>lazy</em> dog.'],
        'knowledge_graph.city.value': ['<em>Roanoke</em>', '<em>Atlanta</em>'],
        'knowledge_graph.state.value': ['<em>Virginia</em>'],
        'knowledge_graph.country.value': ['<em>United States</em>'],
        'knowledge_graph.phone.value': ['<em>1234567890</em>'],
        'knowledge_graph.email.value': ['<em>test1@gmail.com</em>', '<em>test2</em>@gmail.com'],
        'knowledge_graph.review_id.value': ['<em>123456</em>'],
        'knowledge_graph.social_media_id.value': ['twitter <em>username</em>'],
        'knowledge_graph.service.value': ['<em>massage</em>'],
        'knowledge_graph.price.value': ['<em>180</em>'],
        'knowledge_graph.name.value': ['<em>bianca</em>'],
        'knowledge_graph.gender.value': ['<em>female</em>'],
        'knowledge_graph.ethnicity.value': ['<em>hispanic</em>'],
        'knowledge_graph.age.value': ['<em>24</em>'],
        'knowledge_graph.eye_color.value': ['<em>brown</em>'],
        'knowledge_graph.hair_color.value': ['<em>black</em>'],
        'knowledge_graph.height.value': ['<em>155</em>'],
        'knowledge_graph.weight.value': ['<em>60</em>'],
        'tld': ['<em>google.com</em>']
      };

      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      data.hits.hits[0].matched_queries = [
        '1:knowledge_graph.city.value:Roanoke:Virginia:United States:-79.94143:37.27097',
        '1:knowledge_graph.state.value:Roanoke:Virginia:United States:-79.94143:37.27097',
        '1:knowledge_graph.country.value:Roanoke:Virginia:United States:-79.94143:37.27097',
        '2:knowledge_graph.city.value:Atlanta:Georgia:United States:-84.38798:33.749',
        '3:knowledge_graph.phone.value:1234567890',
        '4:knowledge_graph.email.value:test1@gmail.com',
        '5:knowledge_graph.email.value:test2@gmail.com',
        '6:knowledge_graph.review_id.value:123456',
        '7:knowledge_graph.social_media_id.value:twitter username',
        '8:knowledge_graph.service.value:massage',
        '9:knowledge_graph.price.value:180',
        '10:knowledge_graph.name.value:bianca',
        '11:knowledge_graph.gender.value:female',
        '12:knowledge_graph.ethnicity.value:hispanic',
        '13:knowledge_graph.age.value:24',
        '14:knowledge_graph.eye_color.value:brown',
        '15:knowledge_graph.hair_color.value:black',
        '16:knowledge_graph.height.value:155',
        '17:knowledge_graph.weight.value:60',
        '18:tld:google.com'
      ];
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

      data.fields = {
        location: {
          'Roanoke:Virginia:United States:-79.94143:37.27097': 1,
          'Atlanta:Georgia:United States:-84.38798:33.749': 2
        },
        phone: {
          1234567890: 3
        },
        email: {
          'test1@gmail.com': 4,
          'test2@yahoo.com': 5
        },
        review: {
          123456: 6
        },
        social: {
          username: 7
        },
        services: {
          massage: 8
        },
        price: {
          '180': 9
        },
        name: {
          bianca: 10
        },
        gender: {
          female: 11
        },
        ethnicity: {
          hispanic: 12
        },
        age: {
          24: 13
        },
        eyeColor: {
          brown: 14
        },
        hairColor: {
          black: 15
        },
        height: {
          155: 16
        },
        weight: {
          60: 17
        },
        website: {
          'google.com': 18
        }
      };

      output = clientConfig.transforms.offer.queryResults(data)[0];
    });

    test('defines offer', function() {
      assert.equal(output.id, 'FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965');
      assert.equal(output.url, 'http://google.com/abc123');
      assert.equal(output.rank, 1.23);
      assert.equal(output.domain, 'google.com');
      assert.equal(output.type, 'offer');
      assert.equal(output.icon, '');
      assert.equal(output.link, '/offer.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965');
      assert.equal(output.styleClass, '');
      assert.equal(output.title, 'Test Ad');
      assert.equal(output.description, 'The quick brown fox jumped over the lazy dog.');
      assert.equal(output.highlightedText, '<em>Test</em> Ad');
    });

    test('defines publisher array in offer', function() {
      assert.deepEqual(output.publishers, [{
        annotate: false,
        confidence: undefined,
        count: undefined,
        highlight: true,
        id: 'google.com',
        icon: 'av:web',
        link: undefined,
        styleClass: 'entity-light-green',
        text: 'google.com',
        type: 'website'
      }]);
    });

    test('defines location array in offer', function() {
      assert.deepEqual(output.locations, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: 'Roanoke:Virginia:United States:-79.94143:37.27097',
        icon: 'communication:location-on',
        latitude: '37.27097',
        longitude: '-79.94143',
        link: '/location.html?id=Roanoke:Virginia:United States:-79.94143:37.27097',
        styleClass: 'entity-orange',
        text: 'Roanoke, Virginia',
        textAndCount: 'Roanoke, Virginia',
        textAndCountry: 'Roanoke, Virginia, United States',
        type: 'location'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 90,
        count: undefined,
        highlight: true,
        id: 'Atlanta:Georgia:United States:-84.38798:33.749',
        icon: 'communication:location-on',
        latitude: '33.749',
        longitude: '-84.38798',
        link: '/location.html?id=Atlanta:Georgia:United States:-84.38798:33.749',
        styleClass: 'entity-orange',
        text: 'Atlanta, Georgia',
        textAndCount: 'Atlanta, Georgia',
        textAndCountry: 'Atlanta, Georgia, United States',
        type: 'location'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: 'Brooklyn:New York:United States:-73.94958:40.6501',
        icon: 'communication:location-on',
        latitude: '40.6501',
        longitude: '-73.94958',
        link: '/location.html?id=Brooklyn:New York:United States:-73.94958:40.6501',
        styleClass: 'entity-orange',
        text: 'Brooklyn, New York',
        textAndCount: 'Brooklyn, New York',
        textAndCountry: 'Brooklyn, New York, United States',
        type: 'location'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'Houston:Texas:United States:-95.36327:29.76328',
        icon: 'communication:location-on',
        latitude: '29.76328',
        longitude: '-95.36327',
        link: '/location.html?id=Houston:Texas:United States:-95.36327:29.76328',
        styleClass: 'entity-orange',
        text: 'Houston, Texas',
        textAndCount: 'Houston, Texas',
        textAndCountry: 'Houston, Texas, United States',
        type: 'location'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'city',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: 'Columbus:Ohio:United States:-82.99879:39.96118',
        icon: 'communication:location-on',
        latitude: '39.96118',
        longitude: '-82.99879',
        link: '/location.html?id=Columbus:Ohio:United States:-82.99879:39.96118',
        styleClass: 'entity-orange',
        text: 'Columbus, Ohio',
        textAndCount: 'Columbus, Ohio',
        textAndCountry: 'Columbus, Ohio, United States',
        type: 'location'
      }]);
    });

    test('defines phone array in offer', function() {
      assert.deepEqual(output.phones, [{
        annotate: true,
        classifications: {
          database: '',
          type: 'phone',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: '1234567890',
        link: '/phone.html?id=1234567890',
        icon: 'communication:phone',
        styleClass: 'entity-purple',
        text: '123-456-7890',
        type: 'phone'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'phone',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: '+1-2223334444',
        link: '/phone.html?id=+1-2223334444',
        icon: 'communication:phone',
        styleClass: 'entity-purple',
        text: '222-333-4444',
        type: 'phone'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'phone',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '+1-9999999999',
        link: '/phone.html?id=+1-9999999999',
        icon: 'communication:phone',
        styleClass: 'entity-purple',
        text: '999-999-9999',
        type: 'phone'
      }]);
    });

    test('defines email array in offer', function() {
      assert.deepEqual(output.emails, [{
        annotate: true,
        classifications: {
          database: '',
          type: 'email',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: 'test1@gmail.com',
        icon: 'communication:email',
        link: '/email.html?id=test1%40gmail.com',
        styleClass: 'entity-indigo',
        text: 'test1@gmail.com',
        type: 'email'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'email',
          user: ''
        },
        confidence: 70,
        count: undefined,
        highlight: false,
        id: 'test2@yahoo.com',
        icon: 'communication:email',
        link: '/email.html?id=test2%40yahoo.com',
        styleClass: 'entity-indigo',
        text: 'test2@yahoo.com',
        type: 'email'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'email',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'test3@other.com',
        link: '/email.html?id=test3%40other.com',
        icon: 'communication:email',
        styleClass: 'entity-indigo',
        text: 'test3@other.com',
        type: 'email'
      }]);
    });

    test('defines review IDs array in offer', function() {
      assert.deepEqual(output.reviewIds, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'review_id',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: '123456',
        icon: 'icons:star',
        link: undefined,
        styleClass: 'entity-yellow',
        text: '123456',
        type: 'review'
      }]);
    });

    test('defines social media IDs array in offer', function() {
      assert.deepEqual(output.socialIds, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'social_media_id',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: 'username',
        icon: 'social:public',
        link: undefined,
        styleClass: 'entity-red',
        text: 'twitter username',
        type: 'social'
      }]);
    });

    test('defines services array in offer', function() {
      assert.deepEqual(output.services, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'service',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: 'massage',
        icon: 'icons:work',
        link: undefined,
        styleClass: 'entity-brown',
        text: 'massage',
        type: 'service'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'service',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: 'full body',
        icon: 'icons:work',
        link: undefined,
        styleClass: 'entity-brown',
        text: 'full body',
        type: 'service'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'service',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'deep tissue',
        icon: 'icons:work',
        link: undefined,
        styleClass: 'entity-brown',
        text: 'deep tissue',
        type: 'service'
      }]);
    });

    test('defines price array in offer', function() {
      assert.deepEqual(output.prices, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'price',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: '180',
        icon: 'editor:monetization-on',
        link: undefined,
        styleClass: 'entity-green',
        text: '180 roses per 60 minutes',
        type: 'price'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'price',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: '120',
        icon: 'editor:monetization-on',
        link: undefined,
        styleClass: 'entity-green',
        text: '120 per 30 minutes',
        type: 'price'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'price',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '75',
        icon: 'editor:monetization-on',
        link: undefined,
        styleClass: 'entity-green',
        text: '75 per 15 minutes',
        type: 'price'
      }]);
    });

    test('defines name array in offer', function() {
      assert.deepEqual(output.names, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'name',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: 'bianca',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'bianca',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'name',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: 'sweet',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'sweet',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'name',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'woman',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'woman',
        type: 'provider'
      }]);
    });

    test('defines age array in offer', function() {
      assert.deepEqual(output.ages, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'age',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: '24',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '24',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'age',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '25',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '25',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'age',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: '1234567890',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '1234567890',
        type: 'provider'
      }]);
    });

    test('defines ethnicity array in offer', function() {
      assert.deepEqual(output.ethnicities, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'ethnicity',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: 'hispanic',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'hispanic',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'ethnicity',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'brown',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'brown',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'ethnicity',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: 'black',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'black',
        type: 'provider'
      }]);
    });

    test('defines gender array in offer', function() {
      assert.deepEqual(output.genders, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'gender',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: 'female',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'female',
        type: 'provider'
      }]);
    });

    test('defines eye color array in offer', function() {
      assert.deepEqual(output.eyeColors, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'eye_color',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: 'brown',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'brown',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'eye_color',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'black',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'black',
        type: 'provider'
      }]);
    });

    test('defines hair color array in offer', function() {
      assert.deepEqual(output.hairColors, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'hair_color',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: 'black',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'black',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'hair_color',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'brown',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: 'brown',
        type: 'provider'
      }]);
    });

    test('defines height array in offer', function() {
      assert.deepEqual(output.heights, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'height',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: '155',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '155 cm',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'height',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: '5\'1"',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '5\'1"',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'height',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '60',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '60',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'height',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: '1234567890',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '1234567890',
        type: 'provider'
      }]);
    });

    test('defines weight array in offer', function() {
      assert.deepEqual(output.weights, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'weight',
          user: ''
        },
        confidence: 100,
        count: undefined,
        highlight: true,
        id: '60',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '60 kg',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'weight',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: '155',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '155',
        type: 'provider'
      }, {
        annotate: false,
        classifications: {
          database: '',
          type: 'weight',
          user: ''
        },
        confidence: 1,
        count: undefined,
        id: '1234567890',
        icon: 'icons:account-circle',
        link: undefined,
        styleClass: 'entity-teal',
        text: '1234567890',
        type: 'provider'
      }]);
    });

    test('defines detail array in offer', function() {
      assert.deepEqual(output.details, [{
        name: 'Url',
        link: 'http://google.com/abc123',
        text: 'http://google.com/abc123'
      }, {
        highlightedText: 'The <em>quick brown</em> fox jumped over the <em>lazy</em> dog.',
        name: 'Description',
        text: 'The quick brown fox jumped over the lazy dog.'
      }, {
        name: 'Cached Ad Webpage',
        link: '/cache.html?id=FB19C30D81EC27912DC9A3905BDF1BE5484D6697EDA2C5A5BDAFF220887A9965',
        text: 'Open'
      }]);
    });
  });

  suite('<client-config> offer tests with highlights (edge cases)', function() {
    var clientConfig;
    var data;
    var output;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      clientConfig.config = {};
      data = _.cloneDeep(AD_DATA);
      data.hits.hits[0].highlight = {
        'knowldge_graph.email.value': ['<em>test1</em>@gmail.com'],
        'tld': ['<em>google</em>.com']
      };
      output = clientConfig.transforms.offer.offer(data);
    });

    test('does not define highlight in publisher if partial match', function() {
      assert.deepEqual(output.publishers, [{
        annotate: false,
        confidence: undefined,
        count: undefined,
        id: 'google.com',
        icon: 'av:web',
        link: undefined,
        styleClass: 'entity-light-green',
        text: 'google.com',
        type: 'website'
      }]);
    });

    test('does not define highlight in email if partial match', function() {
      assert.deepEqual(output.emails, [{
        annotate: true,
        classifications: {
          database: '',
          type: 'email',
          user: ''
        },
        confidence: 100,
        count: undefined,
        id: 'test1@gmail.com',
        link: '/email.html?id=test1%40gmail.com',
        icon: 'communication:email',
        styleClass: 'entity-indigo',
        text: 'test1@gmail.com',
        type: 'email'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'email',
          user: ''
        },
        confidence: 70,
        count: undefined,
        id: 'test2@yahoo.com',
        link: '/email.html?id=test2%40yahoo.com',
        icon: 'communication:email',
        styleClass: 'entity-indigo',
        text: 'test2@yahoo.com',
        type: 'email'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'email',
          user: ''
        },
        confidence: 30,
        count: undefined,
        id: 'test3@other.com',
        link: '/email.html?id=test3%40other.com',
        icon: 'communication:email',
        styleClass: 'entity-indigo',
        text: 'test3@other.com',
        type: 'email'
      }]);
    });
  });

  suite('<client-config> offer tests if offer result does not have data', function() {
    var clientConfig;
    var output;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      clientConfig.config = {};
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      output = clientConfig.transforms.offer.offer({
        hits: {
          hits: [{
            _source: {
              doc_id: 'testId',
              tld: 'testDomain',
              url: 'testUrl'
            }
          }]
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */
    });

    test('defines offer', function() {
      assert.equal(output.id, 'testId');
      assert.equal(output.url, 'testUrl');
      assert.equal(output.domain, 'testDomain');
      assert.equal(output.type, 'offer');
      assert.equal(output.icon, '');
      assert.equal(output.link, '/offer.html?id=testId');
      assert.equal(output.styleClass, '');
      assert.equal(output.title, 'No Title');
      assert.equal(output.description, 'No Description');
      assert.deepEqual(output.locations, []);
      assert.deepEqual(output.phones, []);
      assert.deepEqual(output.emails, []);
      assert.deepEqual(output.services, []);
      assert.deepEqual(output.prices, []);
      assert.deepEqual(output.names, []);
      assert.deepEqual(output.ages, []);
      assert.deepEqual(output.ethnicities, []);
      assert.deepEqual(output.genders, []);
      assert.deepEqual(output.hairColors, []);
      assert.deepEqual(output.eyeColors, []);
      assert.deepEqual(output.heights, []);
      assert.deepEqual(output.weights, []);
    });

    test('defines date array in offer', function() {
      assert.deepEqual(output.dates, [{
        annotate: false,
        classifications: {
          database: '',
          type: 'posting_date',
          user: ''
        },
        confidence: undefined,
        count: undefined,
        id: undefined,
        icon: 'icons:date-range',
        link: undefined,
        styleClass: 'entity-deep-purple',
        text: 'No Date',
        type: 'date'
      }]);
    });

    test('defines publisher array in offer', function() {
      assert.deepEqual(output.publishers, [{
        annotate: false,
        confidence: undefined,
        count: undefined,
        id: 'testDomain',
        icon: 'av:web',
        link: undefined,
        styleClass: 'entity-light-green',
        text: 'testDomain',
        type: 'website'
      }]);
    });

    test('defines cache in offer', function() {
      assert.deepEqual(output.cache, {
        link: '/cache.html?id=testId',
        text: 'Open Cached Ad Webpage'
      });
    });

    test('defines detail array in offer', function() {
      assert.deepEqual(output.details, [{
        name: 'Url',
        link: 'testUrl',
        text: 'testUrl'
      }, {
        highlightedText: undefined,
        name: 'Description',
        text: 'No Description'
      }, {
        name: 'Cached Ad Webpage',
        link: '/cache.html?id=testId',
        text: 'Open'
      }]);
    });
  });

  suite('<client-config> offer tests if no results from query', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      clientConfig.config = {};
    });

    test('defines empty offer for empty data', function() {
      var output = clientConfig.transforms.offer.offer({
        hits: {
          hits: []
        }
      });
      assert.deepEqual(output, {});
    });

    test('defines empty offer for data with no id', function() {
      var output = clientConfig.transforms.offer.offer({
        hits: {
          hits: [{
            tld: 'google.com',
            url: 'http://google.com'
          }]
        }
      });
      assert.deepEqual(output, {});
    });

    test('defines empty offer for data with no tld', function() {
      var output = clientConfig.transforms.offer.offer({
        hits: {
          hits: [{
            id: '1',
            url: 'http://google.com'
          }]
        }
      });
      assert.deepEqual(output, {});
    });

    test('defines empty offer for data with no url', function() {
      var output = clientConfig.transforms.offer.offer({
        hits: {
          hits: [{
            id: '1',
            url: 'http://google.com'
          }]
        }
      });
      assert.deepEqual(output, {});
    });
  });

  suite('<client-config> offer tests for offer extractions', function() {
    var clientConfig;
    /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
    var data = {
      aggregations: {
        phone: {
          phone: {
            buckets: [{
              doc_count: 10,
              key: '+1-9876543210',
            }, {
              doc_count: 1,
              key: '1234567890',
            }]
          }
        }
      }
    };
    /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      clientConfig.config = {};
    });

    test('defines config object with offer extractions transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig).to.be.an('Object');
      expect(clientConfig.transforms).to.be.an('Object');
      expect(clientConfig.transforms.offer).to.be.an('Object');
      expect(clientConfig.transforms.offer.offerExtractions).to.be.a('Function');
    });

    test('offer extractions function given empty input array returns correct output', function() {
      var output = clientConfig.transforms.offer.offerExtractions([], {
        property: 'phone',
        type: 'phone'
      });
      expect(output).to.deep.equal([]);
    });

    test('offer extractions function given input array and config returns correct output', function() {
      var output = clientConfig.transforms.offer.offerExtractions(data, {
        property: 'phone',
        type: 'phone'
      });
      expect(output).to.deep.equal([{
        annotate: true,
        classifications: {
          database: '',
          type: 'phone',
          user: ''
        },
        confidence: undefined,
        count: 10,
        id: '+1-9876543210',
        icon: 'communication:phone',
        link: '/phone.html?id=+1-9876543210',
        styleClass: 'entity-purple',
        text: '987-654-3210',
        type: 'phone'
      }, {
        annotate: true,
        classifications: {
          database: '',
          type: 'phone',
          user: ''
        },
        confidence: undefined,
        count: 1,
        id: '1234567890',
        icon: 'communication:phone',
        link: '/phone.html?id=1234567890',
        styleClass: 'entity-purple',
        text: '123-456-7890',
        type: 'phone'
      }]);
    });

    test('offer extractions function given input array and config with ID to ignore returns correct output', function() {
      var output = clientConfig.transforms.offer.offerExtractions(data, {
        ignoreId: '+1-9876543210',
        property: 'phone',
        type: 'phone'
      });
      expect(output).to.deep.equal([{
        annotate: true,
        classifications: {
          database: '',
          type: 'phone',
          user: ''
        },
        confidence: undefined,
        count: 1,
        id: '1234567890',
        icon: 'communication:phone',
        link: '/phone.html?id=1234567890',
        styleClass: 'entity-purple',
        text: '123-456-7890',
        type: 'phone'
      }]);
    });
  });

  suite('<client-config> offer tests for offer extractions title', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      clientConfig.config = {};
    });

    test('defines config object with offer extractions title transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig).to.be.an('Object');
      expect(clientConfig.transforms).to.be.an('Object');
      expect(clientConfig.transforms.offer).to.be.an('Object');
      expect(clientConfig.transforms.offer.offerExtractionsTitle).to.be.a('Function');
    });

    test('offer extractions title function given size=0 returns correct output', function() {
      var output = clientConfig.transforms.offer.offerExtractionsTitle(0, {
        type: 'phone'
      });
      expect(output).to.equal('No Telephone Numbers');
    });

    test('offer extractions title function given size=1 returns correct output', function() {
      var output = clientConfig.transforms.offer.offerExtractionsTitle(1, {
        type: 'phone'
      });
      expect(output).to.equal('1 Telephone Number');
    });

    test('offer extractions title function given size=2 returns correct output', function() {
      var output = clientConfig.transforms.offer.offerExtractionsTitle(2, {
        type: 'phone'
      });
      expect(output).to.equal('2 Telephone Numbers');
    });

    test('offer extractions title function given type=email returns correct output', function() {
      var output = clientConfig.transforms.offer.offerExtractionsTitle(2, {
        type: 'email'
      });
      expect(output).to.equal('2 Email Addresses');
    });

    test('offer extractions title function given sayOther=true returns correct output', function() {
      var output = clientConfig.transforms.offer.offerExtractionsTitle(2, {
        sayOther: true,
        type: 'phone'
      });
      expect(output).to.equal('2 Other Telephone Numbers');
    });
  });

  suite('<client-config> offer tests for the locations with icons', function() {
    var clientConfig;
    var primary = [{
      id: 'Atlanta:Georgia:United States:-84.38798:33.749'
    }];
    var secondary = [{
      id: 'Brooklyn:New York:United States:-73.94958:40.6501'
    }, {
      id: 'Houston:Texas:United States:-95.36327:29.76328'
    }];

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      clientConfig.config = {};
    });

    test('defines config object with locations with icons transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig).to.be.an('Object');
      expect(clientConfig.transforms).to.be.an('Object');
      expect(clientConfig.transforms.offer).to.be.an('Object');
      expect(clientConfig.transforms.offer.locationsWithIcons).to.be.a('Function');
    });

    test('locations with icons function given empty primary array does return undefined', function() {
      var output = clientConfig.transforms.offer.locationsWithIcons([], secondary);
      expect(output).to.not.exist;
    });

    test('locations with icons function given primary array and empty secondary array does return correct array', function() {
      var output = clientConfig.transforms.offer.locationsWithIcons(primary, []);
      expect(output).to.deep.equal([{
        iconId: 'mainLocation',
        id: 'Atlanta:Georgia:United States:-84.38798:33.749'
      }]);
    });

    test('locations with icons function given primary and secondary array does return correct array', function() {
      var output = clientConfig.transforms.offer.locationsWithIcons(primary, secondary);
      expect(output).to.deep.equal([{
        iconId: 'mainLocation',
        id: 'Atlanta:Georgia:United States:-84.38798:33.749'
      }, {
        id: 'Brooklyn:New York:United States:-73.94958:40.6501'
      }, {
        id: 'Houston:Texas:United States:-95.36327:29.76328'
      }]);
    });
  });

  suite('<client-config> offer revisions tests', function() {
    var clientConfig;

    setup(function() {
      clientConfig = fixture('client-config-fixture');
      clientConfig.config = {};
    });

    test('defines config object with revisions transform function', function() {
      expect(clientConfig).to.exist;
      expect(clientConfig).to.be.an('Object');
      expect(clientConfig.transforms).to.be.an('Object');
      expect(clientConfig.transforms.offer).to.be.an('Object');
      expect(clientConfig.transforms.offer.revisions).to.be.an('Function');
    });

    test('defines revisions for multiple dates', function() {
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      var output = clientConfig.transforms.offer.revisions({
        aggregations: {
          revisions: {
            doc_count: 15,
            revisions: {
              buckets: [{
                key_as_string: '2016-01-01T00:00:00.000Z',
                doc_count: 10
              }, {
                key_as_string: '2016-01-02T00:00:00.000Z',
                doc_count: 5
              }]
            }
          }
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

      expect(output).to.deep.equal([{
        date: 'Jan 1, 2016',
        list: [{
          count: 10,
          label: 'Revision on Jan 1, 2016'
        }]
      }, {
        date: 'Jan 2, 2016',
        list: [{
          count: 5,
          label: 'Revision on Jan 2, 2016'
        }]
      }]);
    });

    test('defines revisions for single date with multiple revisions', function() {
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      var output = clientConfig.transforms.offer.revisions({
        aggregations: {
          revisions: {
            doc_count: 5,
            revisions: {
              buckets: [{
                key_as_string: '2016-01-01T00:00:00.000Z',
                doc_count: 5
              }]
            }
          }
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

      expect(output).to.deep.equal([{
        date: 'Jan 1, 2016',
        list: [{
          count: 5,
          label: 'Revision on Jan 1, 2016'
        }]
      }]);
    });

    test('defines revisions for a single date with single revision as an empty array', function() {
      /* jscs:disable requireCamelCaseOrUpperCaseIdentifiers */
      var output = clientConfig.transforms.offer.revisions({
        aggregations: {
          revisions: {
            doc_count: 1,
            revisions: {
              buckets: [{
                key_as_string: '2016-01-01T00:00:00.000Z',
                doc_count: 1
              }]
            }
          }
        }
      });
      /* jscs:enable requireCamelCaseOrUpperCaseIdentifiers */

      expect(output).to.deep.equal([]);
    });
  });
</script>
</body>
</html>
