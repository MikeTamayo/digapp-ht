<!doctype html>
<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <title>state-behavior</title>

  <script src="../bower_components/webcomponentsjs/webcomponents.min.js"></script>
  <script src="../bower_components/web-component-tester/browser.js"></script>
  <script src="../bower_components/test-fixture/test-fixture-mocha.js"></script>
  <link rel="import" href="../bower_components/test-fixture/test-fixture.html">

  <link rel="import" href="../bower_components/polymer/polymer.html">
  <script src="../behaviors/state-behavior.js"></script>
</head>
<body>

<dom-module id="test-state-behavior-component">
  <template>
  </template>
  <script>
    /* globals DigBehaviors, HTMLImports, Polymer */
    HTMLImports.whenReady(function() {
      Polymer({
        is: 'test-state-behavior-component',
        behaviors: [DigBehaviors.StateBehavior]
      });
    });
  </script>
</dom-module>

<test-fixture id="state-behavior-fixture">
  <template>
    <test-state-behavior-component></test-state-behavior-component>
  </template>
</test-fixture>

<script>
  /* globals suite, setup, fixture, test, expect */
  /* jshint -W030 */
  suite('state-behavior tests', function() {
    var component;

    setup(function() {
      component = fixture('state-behavior-fixture');
    });

    test('has needed functions', function() {
      expect(component.buildEntityState).to.be.a('Function');
      expect(component.buildSearchStateForES).to.be.a('Function');
      expect(component.buildSearchStateForUI).to.be.a('Function');
    });

    test('buildEntityState given empty object returns default state object', function() {
      expect(component.buildEntityState({})).to.deep.equal({
        location: [],
        name: [],
        age: [],
        ethnicity: [],
        eyeColor: [],
        hairColor: [],
        height: [],
        weight: []
      });
    });

    test('buildEntityState returns new state object', function() {
      var input = {
        location: ['myLocation'],
        name: ['myName'],
        age: ['myAge'],
        ethnicity: ['myEthnicity'],
        eyeColor: ['myEyeColor'],
        hairColor: ['myHairColor'],
        height: ['myHeight'],
        weight: ['myWeight']
      };
      var output = component.buildEntityState(input);
      expect(output).to.not.equal(input);
      expect(output).to.deep.equal(input);
    });

    test('buildEntityState ignores unexpected properties', function() {
      expect(component.buildEntityState({
        otherValue: ['myOtherValue']
      })).to.deep.equal({
        location: [],
        name: [],
        age: [],
        ethnicity: [],
        eyeColor: [],
        hairColor: [],
        height: [],
        weight: []
      });
    });

    test('buildSearchStateForES given empty object returns default state object', function() {
      expect(component.buildSearchStateForES({})).to.deep.equal({
        dateCreated: {},
        country: {},
        city: {},
        phone: {},
        email: {},
        website: {},
        name: {},
        age: {},
        ethnicity: {},
        eyeColor: {},
        hairColor: {},
        height: {},
        weight: {},
        hasImage: {},
        sort: '',
        text: ''
      });
    });

    test('buildSearchStateForES returns new state object', function() {
      var input = {
        dateCreated: {
          date: 'myDate'
        },
        country: {
          country: 'myCountry'
        },
        city: {
          city: 'myCity'
        },
        phone: {
          phone: 'myPhone'
        },
        email: {
          email: 'myEmail'
        },
        website: {
          website: 'myWebsite'
        },
        name: {
          name: 'myName'
        },
        age: {
          age: 'myAge'
        },
        ethnicity: {
          ethnicity: 'myEthnicity'
        },
        eyeColor: {
          eye: 'myEye'
        },
        hairColor: {
          hair: 'myHair'
        },
        height: {
          height: 'myHeight'
        },
        weight: {
          weight: 'myWeight'
        },
        hasImage: {
          answer: 'myAnswer'
        },
        sort: 'mySort',
        text: 'myText'
      };
      var output = component.buildSearchStateForES(input);
      expect(output).to.not.equal(input);
      expect(output).to.deep.equal(input);
    });

    test('buildSearchStateForES ignores unexpected properties', function() {
      expect(component.buildSearchStateForES({
        otherValue: ['myOtherValue']
      })).to.deep.equal({
        dateCreated: {},
        country: {},
        city: {},
        phone: {},
        email: {},
        website: {},
        name: {},
        age: {},
        ethnicity: {},
        eyeColor: {},
        hairColor: {},
        height: {},
        weight: {},
        hasImage: {},
        sort: '',
        text: ''
      });
    });

    test('buildSearchStateForUI given empty object returns default state object', function() {
      expect(component.buildSearchStateForUI({})).to.deep.equal({
        dateCreated: {},
        country: {},
        city: {},
        phone: {},
        email: {},
        website: {},
        name: {},
        age: {},
        ethnicity: {},
        eyeColor: {},
        hairColor: {},
        height: {},
        weight: {},
        hasImage: {},
        annotationsFilter: {},
        sort: '',
        text: ''
      });
    });

    test('buildSearchStateForUI returns new state object', function() {
      var input = {
        dateCreated: {
          date: 'myDate'
        },
        country: {
          country: 'myCountry'
        },
        city: {
          city: 'myCity'
        },
        phone: {
          phone: 'myPhone'
        },
        email: {
          email: 'myEmail'
        },
        website: {
          website: 'myWebsite'
        },
        name: {
          name: 'myName'
        },
        age: {
          age: 'myAge'
        },
        ethnicity: {
          ethnicity: 'myEthnicity'
        },
        eyeColor: {
          eye: 'myEye'
        },
        hairColor: {
          hair: 'myHair'
        },
        height: {
          height: 'myHeight'
        },
        weight: {
          weight: 'myWeight'
        },
        hasImage: {
          answer: 'myAnswer'
        },
        annotationsFilter: {
          filter: 'myFilter'
        },
        sort: 'mySort',
        text: 'myText'
      };

      var output = component.buildSearchStateForUI(input);
      expect(output).to.not.equal(input);
      expect(output.dateCreated).to.deep.equal(input.dateCreated);
      expect(output.country).to.deep.equal(input.country);
      expect(output.city).to.deep.equal(input.city);
      expect(output.phone).to.deep.equal(input.phone);
      expect(output.email).to.deep.equal(input.email);
      expect(output.website).to.deep.equal(input.website);
      expect(output.name).to.deep.equal(input.name);
      expect(output.age).to.deep.equal(input.age);
      expect(output.ethnicity).to.deep.equal(input.ethnicity);
      expect(output.eyeColor).to.deep.equal(input.eyeColor);
      expect(output.hairColor).to.deep.equal(input.hairColor);
      expect(output.height).to.deep.equal(input.height);
      expect(output.weight).to.deep.equal(input.weight);
      expect(output.hasImage).to.deep.equal(input.hasImage);
      expect(output.annotationsFilter).to.deep.equal({});
      expect(output.sort).to.equal(input.sort);
      expect(output.text).to.equal(input.text);
    });

    test('buildSearchStateForUI ignores unexpected properties', function() {
      expect(component.buildSearchStateForUI({
        otherValue: ['myOtherValue']
      })).to.deep.equal({
        dateCreated: {},
        country: {},
        city: {},
        phone: {},
        email: {},
        website: {},
        name: {},
        age: {},
        ethnicity: {},
        eyeColor: {},
        hairColor: {},
        height: {},
        weight: {},
        hasImage: {},
        annotationsFilter: {},
        sort: '',
        text: ''
      });
    });
  });
</script>
</body>
</html>
