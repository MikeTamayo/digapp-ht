<!--
Copyright 2017 Next Century Corporation

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/aggregation-query-and-display/aggregation-query-and-display.html">
<link rel="import" href="../../bower_components/elastic-error/elastic-error.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../styles/icon-styles.html">

<dom-module id="people-features">
  <template>
    <style include="icon-styles"></style>
    <style include="iron-flex iron-flex-factors"></style>

    <style>
      :host {
        display: block;
        overflow-x: auto;
      }

      aggregation-query-and-display {
        /* TODO Change to min-width 150px if columns are reduced from 4 to 3 */
        min-width: 100px;
      }

      .add-side-margins {
        margin: 0 10px;
      }

      .add-large-bottom-margin {
        margin-bottom: 15px;
      }

      .add-small-bottom-margin {
        margin-bottom: 5px;
      }
    </style>

    <div class="layout horizontal add-large-bottom-margin">
      <div class="flex-4">
        <aggregation-query-and-display class="flex-2" small
          aggregation-name="service"
          aggregation-field="knowledge_graph.service.key"
          aggregation-count="[[aggregationCount]]"
          selected-property="[[selectedServicesProperty]]"
          selected="{{selected}}"
          query-field="[[queryField]]"
          query-value="[[queryValue]]"
          client="[[client]]"
          index-name="[[indexName]]"
          index-types='["ads"]'
          filter-list="[[filterList]]"
          properties-ready="[[propertiesReady]]"
          transform-config='{"property":"service","type":"service"}'
          transform-function="[[transformFunction]]"
          header-data-name="Services"
          header-counts-name="Ads"
          show-checkboxes>
        </aggregation-query-and-display>
      </div>

      <div class="flex-4">
        <aggregation-query-and-display class="flex-2 add-side-margins" small
          aggregation-name="price"
          aggregation-field="knowledge_graph.price.key"
          aggregation-count="[[aggregationCount]]"
          selected-property="[[selectedPriceProperty]]"
          selected="{{selected}}"
          query-field="[[queryField]]"
          query-value="[[queryValue]]"
          client="[[client]]"
          index-name="[[indexName]]"
          index-types='["ads"]'
          filter-list="[[filterList]]"
          properties-ready="[[propertiesReady]]"
          transform-config='{"property":"price","type":"price"}'
          transform-function="[[transformFunction]]"
          header-data-name="Price"
          header-counts-name="Ads"
          show-checkboxes>
        </aggregation-query-and-display>
      </div>

      <div class="flex-4">
        <aggregation-query-and-display class="flex-2" small
          aggregation-name="name"
          aggregation-field="knowledge_graph.name.key"
          aggregation-count="[[aggregationCount]]"
          selected-property="[[selectedNameProperty]]"
          selected="{{selected}}"
          query-field="[[queryField]]"
          query-value="[[queryValue]]"
          client="[[client]]"
          index-name="[[indexName]]"
          index-types='["ads"]'
          filter-list="[[filterList]]"
          properties-ready="[[propertiesReady]]"
          transform-config='{"property":"name","type":"name"}'
          transform-function="[[transformFunction]]"
          header-data-name="Name"
          header-counts-name="Ads"
          show-checkboxes>
        </aggregation-query-and-display>
      </div>
    </div>

    <div class="layout horizontal add-small-bottom-margin">
      <div class="flex-4">
        <aggregation-query-and-display class="flex-2" small
          aggregation-name="age"
          aggregation-field="knowledge_graph.age.key"
          aggregation-count="[[aggregationCount]]"
          selected-property="[[selectedAgeProperty]]"
          selected="{{selected}}"
          query-field="[[queryField]]"
          query-value="[[queryValue]]"
          client="[[client]]"
          index-name="[[indexName]]"
          index-types='["ads"]'
          filter-list="[[filterList]]"
          properties-ready="[[propertiesReady]]"
          transform-config='{"property":"age","type":"age"}'
          transform-function="[[transformFunction]]"
          header-data-name="Age"
          header-counts-name="Ads"
          show-checkboxes>
        </aggregation-query-and-display>
      </div>

      <div class="flex-4">
        <aggregation-query-and-display class="flex-2 add-side-margins" small
          aggregation-name="ethnicity"
          aggregation-field="knowledge_graph.ethnicity.key"
          aggregation-count="[[aggregationCount]]"
          selected-property="[[selectedEthnicityProperty]]"
          selected="{{selected}}"
          query-field="[[queryField]]"
          query-value="[[queryValue]]"
          client="[[client]]"
          index-name="[[indexName]]"
          index-types='["ads"]'
          filter-list="[[filterList]]"
          properties-ready="[[propertiesReady]]"
          transform-config='{"property":"ethnicity","type":"ethnicity"}'
          transform-function="[[transformFunction]]"
          header-data-name="Ethnicity"
          header-counts-name="Ads"
          show-checkboxes>
        </aggregation-query-and-display>
      </div>

      <div class="flex-4">
        <aggregation-query-and-display class="flex-2" small
          aggregation-name="eyeColor"
          aggregation-field="knowledge_graph.eye_color.key"
          aggregation-count="[[aggregationCount]]"
          selected-property="[[selectedEyeColorProperty]]"
          selected="{{selected}}"
          query-field="[[queryField]]"
          query-value="[[queryValue]]"
          client="[[client]]"
          index-name="[[indexName]]"
          index-types='["ads"]'
          filter-list="[[filterList]]"
          properties-ready="[[propertiesReady]]"
          transform-config='{"property":"eyeColor","type":"eyeColor"}'
          transform-function="[[transformFunction]]"
          header-data-name="Eye Color"
          header-counts-name="Ads"
          show-checkboxes>
        </aggregation-query-and-display>
      </div>
    </div>

    <div class="layout horizontal add-small-bottom-margin">
      <div class="flex-4">
        <aggregation-query-and-display class="flex-2" small
          aggregation-name="hairColor"
          aggregation-field="knowledge_graph.hair_color.key"
          aggregation-count="[[aggregationCount]]"
          selected-property="[[selectedHairColorProperty]]"
          selected="{{selected}}"
          query-field="[[queryField]]"
          query-value="[[queryValue]]"
          client="[[client]]"
          index-name="[[indexName]]"
          index-types='["ads"]'
          filter-list="[[filterList]]"
          properties-ready="[[propertiesReady]]"
          transform-config='{"property":"hairColor","type":"hairColor"}'
          transform-function="[[transformFunction]]"
          header-data-name="Hair Color"
          header-counts-name="Ads"
          show-checkboxes>
        </aggregation-query-and-display>
      </div>

      <div class="flex-4">
        <aggregation-query-and-display class="flex-2 add-side-margins" small
          aggregation-name="height"
          aggregation-field="knowledge_graph.height.key"
          aggregation-count="[[aggregationCount]]"
          selected-property="[[selectedHeightProperty]]"
          selected="{{selected}}"
          query-field="[[queryField]]"
          query-value="[[queryValue]]"
          client="[[client]]"
          index-name="[[indexName]]"
          index-types='["ads"]'
          filter-list="[[filterList]]"
          properties-ready="[[propertiesReady]]"
          transform-config='{"property":"height","type":"height"}'
          transform-function="[[transformFunction]]"
          header-data-name="Height"
          header-counts-name="Ads"
          show-checkboxes>
        </aggregation-query-and-display>
      </div>

      <div class="flex-4">
        <aggregation-query-and-display class="flex-2" small
          aggregation-name="weight"
          aggregation-field="knowledge_graph.weight.key"
          aggregation-count="[[aggregationCount]]"
          selected-property="[[selectedWeightProperty]]"
          selected="{{selected}}"
          query-field="[[queryField]]"
          query-value="[[queryValue]]"
          client="[[client]]"
          index-name="[[indexName]]"
          index-types='["ads"]'
          filter-list="[[filterList]]"
          properties-ready="[[propertiesReady]]"
          transform-config='{"property":"weight","type":"weight"}'
          transform-function="[[transformFunction]]"
          header-data-name="Weight"
          header-counts-name="Ads"
          show-checkboxes>
        </aggregation-query-and-display>
      </div>
    </div>
  </template>

  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'people-features',

      properties: {
        /**
         * The field for the elasticsearch query.
         */
        queryField: {
          type: String
        },

        /**
         * The value for the elasticsearch query.
         */
        queryValue: {
          type: String
        },

        /**
         * The count of results for all the elasticsearch aggregations.  Default is 0 (all results).
         */
        aggregationCount: {
          type: Number,
          value: 0
        },

        /**
         * The elasticsearch client.
         */
        client: {
          type: Object
        },

        /**
         * The elasticsearch index to query.
         */
        indexName: {
          type: String
        },

        /**
         * The list of elasticjs filters used in the aggregations run by this component.
         */
        filterList: {
          type: Array
        },

        /**
         * The object containing the selected lists.
         */
        selected: {
          notify: true,
          type: Object
        },

        /**
         * The property in `selected` containing the list of selected age strings.
         */
        selectedAgeProperty: {
          type: String
        },

        /**
         * The property in `selected` containing the list of selected ethnicity strings.
         */
        selectedEthnicityProperty: {
          type: String
        },

        /**
         * The property in `selected` containing the list of selected eye color strings.
         */
        selectedEyeColorProperty: {
          type: String
        },

        /**
         * The property in `selected` containing the list of selected hair color strings.
         */
        selectedHairColorProperty: {
          type: String
        },

        /**
         * The property in `selected` containing the list of selected height strings.
         */
        selectedHeightProperty: {
          type: String
        },

        /**
         * The property in `selected` containing the list of selected name strings.
         */
        selectedNameProperty: {
          type: String
        },

        /**
         * The property in `selected` containing the list of selected price strings.
         */
        selectedPriceProperty: {
          type: String
        },

        /**
         * The property in `selected` containing the list of selected services strings.
         */
        selectedServicesProperty: {
          type: String
        },

        /**
         * The property in `selected` containing the list of selected weight strings.
         */
        selectedWeightProperty: {
          type: String
        },

        /**
         * The error for the age feature.
         */
        ageError: {
          type: Object
        },

        /**
         * The error for the ethnicity feature.
         */
        ethnicityError: {
          type: Object
        },

        /**
         * The error for the eye color feature.
         */
        eyeError: {
          type: Object
        },

        /**
         * The error for the hair color feature.
         */
        hairError: {
          type: Object
        },

        /**
         * The error for the height feature.
         */
        heightError: {
          type: Object
        },

        /**
         * The error for the name feature.
         */
        nameError: {
          type: Object
        },

        /**
         * The error for the price feature.
         */
        priceError: {
          type: Object
        },

        /**
         * The error for the services feature.
         */
        servicesError: {
          type: Object
        },

        /**
         * The error for the weight feature.
         */
        weightError: {
          type: Object
        },

        /**
         * Whether or not to display a checkbox in each horizontal-bar.
         */
        showCheckboxes: {
          type: Boolean,
          value: false
        },

        /**
         * The transform function.
         */
        transformFunction: {
          type: Object
        },

        /**
         * (Optional)
         *
         * Whether the elasticsearch query is ready to be run.  False forbids the query to be run at all.
         *
         * @type {Boolean}
         * @default true
         */
        propertiesReady: {
          type: Boolean,
          value: true
        }
      }
    });
  })();
  </script>
</dom-module>
