<!--
Copyright 2017 Next Century Corporation

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../behaviors.html">
<link rel="import" href="../../styles/facet-styles.html">

<dom-module id="date-range-facet">
  <template>
    <style include="iron-flex"></style>
    <style include="facet-styles"></style>
    <style>
      :host {
        display: block;
      }

      .filter-list > date-picker-display {
        padding-bottom: 5px;
        padding-top: 15px;
      }
    </style>
    <!-- title section of date range facet -->
    <div id="header" class="layout horizontal facet filter-header" title="Toggle [[headerTitle]]s" on-tap="toggleList">
      <span class="flex">[[headerTitle]]</span>
      <iron-icon id="icon-opened" class$="[[_getOpenedIconClass(opened)]]" icon$="[[openedIcon]]"></iron-icon>
      <iron-icon id="icon-closed" class$="[[_getClosedIconClass(opened)]]" icon$="[[closedIcon]]"></iron-icon>
    </div>

    <!-- display of date pickers -->
    <iron-collapse id="list" class="filter-list" opened="{{opened}}">
      <date-picker-display
        facet-selection="{{searchParamSubset}}"
        key="[[dateStartKey]]"
        title="[[dateStartTitle]]"
        prefix-label="[[dateStartPrefixLabel]]"
        date-identifier="[[dateStartIdentifier]]">
      </date-picker-display>

      <date-picker-display
        facet-selection="{{searchParamSubset}}"
        key="[[dateEndKey]]"
        title="[[dateEndTitle]]"
        prefix-label="[[dateEndPrefixLabel]]"
        date-identifier="[[dateEndIdentifier]]">
      </date-picker-display>
    </iron-collapse>

  </template>

  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'date-range-facet',

      properties: {
        /**
         * Title to use in header.
         */
        headerTitle: {
          type: String,
          notify: true,
          value: 'Date'
        },
        /**
         * Subset of searchParameters to pass along to the date-picker-display.
         */
        searchParamSubset: {
          type: Object,
          notify: true
        },
        /**
         * Key for the start date.
         */
        dateStartKey: {
          type: String,
          notify: true
        },
        /**
         * Title for the start date.
         */
        dateStartTitle: {
          type: String,
          notify: true
        },
        /**
         * Prefix label for the start date (i.e. 'From').
         */
        dateStartPrefixLabel: {
          type: String,
          notify: true
        },
        /**
         * Unique identifier for the start date.
         */
        dateStartIdentifier: {
          type: String,
          notify: true
        },
        /**
         * Key for the end date.
         */
        dateEndKey: {
          type: String,
          notify: true
        },
        /**
         * Title for the end date.
         */
        dateEndTitle: {
          type: String,
          notify: true
        },
        /**
         * Prefix label for the end date (i.e. 'To').
         */
        dateEndPrefixLabel: {
          type: String,
          notify: true
        },
        /**
         * Unique identifier for the end date.
         */
        dateEndIdentifier: {
          type: String,
          notify: true
        },
        /**
         * Whether or not the list of date facets is opened.
         */
        opened: {
          type: Boolean,
          value: true,
          notify: true
        },
        /**
         * Icon to use for when list of date facets is opened.
         */
        openedIcon: {
          type: String,
          value: 'icons:expand-less'
        },
        /**
         * Icon to use for when list of date facets is collapsed.
         */
        closedIcon: {
          type: String,
          value: 'icons:expand-more'
        }

      },
      toggleList: function() {
        this.$$('#list').toggle();
      },
      _getOpenedIconClass: function(opened) {
        return opened === true ? 'show' : 'hide';
      },
      _getClosedIconClass: function(opened) {
        return opened === false ? 'show' : 'hide';
      }
    });
  })();
  </script>
</dom-module>
